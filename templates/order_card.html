<div class="order-card">
    <div class="order-header">
        <h5>Order #{{ order.id }}</h5>
        <span class="order-status status-{{ order.status }}">{{ order.get_status_display }}</span>
    </div>
    <p>Date: {{ order.created_at|date:"F d, Y" }}</p>
    {% if order.tracking_number %}
        <p>Tracking Number: {{ order.tracking_number }}</p>
    {% endif %}
    <div class="order-items">
        {% for item in order.items.all %}
            <div class="order-item">
                <p>{{ item.product.name }} - Quantity: {{ item.quantity }}</p>
            </div>
        {% endfor %}
    </div>
    <p class="order-total">Total: ${{ order.total_price }}</p>
    <a href="{% url 'order_detail' order.id %}" class="btn btn-primary mt-2">View Details</a>
    
    {% if user.is_staff %}
        <form action="{% url 'update_order_status' order.id %}" method="post" class="mt-3">
            {% csrf_token %}
            <select name="status" class="form-select">
                {% for status, display in order.STATUS_CHOICES %}
                    <option value="{{ status }}" {% if order.status == status %}selected{% endif %}>{{ display }}</option>
                {% endfor %}
            </select>
            <button type="submit" class="btn btn-primary mt-2">Update Status</button>
        </form>
        
        {% if order.status == 'shipped' and not order.tracking_number %}
            <form action="{% url 'add_tracking_number' order.id %}" method="post" class="mt-3">
                {% csrf_token %}
                <input type="text" name="tracking_number" placeholder="Enter tracking number" class="form-control">
                <button type="submit" class="btn btn-primary mt-2">Add Tracking Number</button>
            </form>
        {% endif %}
    {% endif %}
</div>